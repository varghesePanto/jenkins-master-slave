version: "3"

services:
  master:
    build: .
    ports:
      - 8080:8080
      - 50000:50000
    volumes:
      - ./jenkins_home:/var/jenkins_home
    links:
      - agent

  agent:
    image: jenkinsci/ssh-slave
    ports:
      - "2222:22"
    volumes:
      - ./jenkins_slave_home:/home/jenkins
    environment:
      - JENKINS_SLAVE_SSH_PUBKEY=